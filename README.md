# MoveNet single pose tracking on OpenVINO

Running Google MoveNet Single Pose models on OpenVINO.

A convolutional neural network model that runs on RGB images and predicts human joint
locations of a single person. Two variant: Lightning and Thunder, the latter being slower but more accurate.

**WIP**. The current implementation of this repository does not include yet the 2 following features useful when the input is a video : the auto cropping (the position of the body in frame N is used to crop the frame N+1 allowing a better precision) and a smoothing filter. 

For Blazepose, a challenger, please visit : [openvino_blazepose](https://github.com/geaxgx/openvino_blazepose)


## Install

You need OpenVINO 2021.3 (does not work with 2021.2) and OpenCV installed on your computer and to clone/download this repository.

## Run

**Usage:**

```
> python3 MovenetOpenvino.py -h                                               
usage: MovenetOpenvino.py [-h] [-i INPUT] [-p {16,32}]
                          [-m {lightning,thunder}] [--xml XML] [-d DEVICE]
                          [-t SCORE_THRESHOLD] [-c] [-o OUTPUT]

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT, --input INPUT
                        Path to video or image file to use as input
                        (default=0)
  -p {16,32}, --precision {16,32}
                        Precision (default=32
  -m {lightning,thunder}, --model {lightning,thunder}
                        Model to use (default=thunder
  --xml XML             Path to an .xml file for model
  -d DEVICE, --device DEVICE
                        Target device to run the model (default=CPU)
  -t SCORE_THRESHOLD, --score_threshold SCORE_THRESHOLD
                        Minimum score threshold for landmarks (default=0)
  -c, --crop            Center crop frames to a square shape before feeding
                        pose detection model
  -o OUTPUT, --output OUTPUT
                        Path to output video file

```
**Examples :**

- To use default webcam camera as input, Thunder model on CPU :

    ```python3 MovenetOpenvino.py```

- To use a file (video or image) as input :

    ```python3 MovenetOpenvino.py -i filename```

- To use Lightning instead of Thunder the version of the landmark model (default="full", other options are "lite" (faster but less accurate) and "heavy" (more accurate but slower). Example :

    ```python3 BlazeposeOpenvino.py -m lightning```


## The models 
They were generated by PINTO and are also available there: https://github.com/PINTO0309/PINTO_model_zoo/tree/main/115_MoveNet


## Credits
* [Google Next-Generation Pose Detection with MoveNet and TensorFlow.js](https://blog.tensorflow.org/2021/05/next-generation-pose-detection-with-movenet-and-tensorflowjs.html)
* Katsuya Hyodo a.k.a [Pinto](https://github.com/PINTO0309), the Wizard of Model Conversion !
